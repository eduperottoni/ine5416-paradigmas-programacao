(defpackage :board
  (:use :cl)
  (:export :generate-kojun))

(in-package :board)

"Gera um exemplo de problema Kojun e seu respectivo tabuleiro de regiões para um dado tamanho.
Esta função retorna tabuleiros predefinidos com base no tamanho especificado.
Para tamanhos inexistentes, ela irá gerar um erro.

Parâmetros:
size: O tamanho do tabuleiro de Kojun ()

Retorna:
Uma tupla onde o primeiro elemento é o tabuleiro Kojun e o segundo elemento é o tabuleiro de regiões"
(defun generate-kojun (size)
  (cond
    ((= size 6) (list board6 regions-board6))
    ((= size 8) (list board8 regions-board8))
    ((= size 10) (list board10 regions-board10))
    ((= size 12) (list board12 regions-board12))
    ((= size 14) (list board14 regions-board14))
    ((= size 17) (list board17 regions-board17))
    (t (error "Unsupported board size"))))

;; Example 6x6 board and regions
(defparameter board6
  '((0 0 0 0 0 2)
    (2 0 0 5 0 0)
    (0 0 3 0 0 4)
    (0 0 0 3 0 1)
    (0 0 0 0 0 0)
    (0 0 3 0 2 5)))

(defparameter regions-board6
  '((0 1 2 2 3 3)
    (0 1 4 3 3 3)
    (0 0 4 4 4 5)
    (6 6 7 5 5 5)
    (6 6 7 8 9 9)
    (10 10 8 8 8 8)))

;; Example 8x8 board and regions
(defparameter board8
  '((0 1 0 0 3 0 0 5)
    (0 0 0 1 0 0 2 3)
    (0 0 2 0 0 0 6 0)
    (0 0 3 4 0 0 0 0)
    (4 7 0 6 1 5 0 0)
    (0 0 1 0 0 0 0 0)
    (6 0 0 0 0 4 0 7)
    (3 4 1 0 2 0 0 0)))

(defparameter regions-board8
  '((0 0 0 6 6 6 6 7)
    (1 1 1 5 5 7 6 7)
    (3 2 4 4 4 7 7 7)
    (3 3 8 8 8 9 9 9)
    (15 15 15 15 8 11 11 10)
    (16 15 15 15 13 11 11 10)
    (16 16 16 14 13 14 11 11)
    (16 16 16 14 14 14 11 12)))

;; Example 10x10 board and regions
(defparameter board10
  '((0 0 0 2 4 0 3 0 0 3)
    (3 0 5 0 0 0 0 1 4 0)
    (2 0 0 0 0 2 1 0 0 2)
    (1 6 5 0 1 5 2 0 0 0)
    (0 0 0 0 0 0 0 5 0 6)
    (6 0 3 0 3 0 0 0 0 4)
    (0 0 0 0 0 2 4 0 7 2)
    (4 0 2 0 2 0 0 5 3 0)
    (0 0 0 3 0 6 0 0 0 0)
    (0 1 0 1 0 0 0 5 0 0)))

(defparameter regions-board10
  '((0 0 0 0 2 2 3 4 4 4)
    (1 0 0 7 2 2 3 3 4 5)
    (1 1 1 7 7 2 2 4 4 6)
    (1 10 10 7 7 8 8 4 6 6)
    (11 11 10 10 8 8 8 9 6 9)
    (11 10 10 10 12 12 9 9 9 9)
    (11 13 15 16 16 12 12 12 12 9)
    (11 13 13 17 16 12 19 20 20 21)
    (11 14 13 18 16 19 19 20 20 20)
    (11 14 14 18 18 19 19 19 20 20)))

;; Example 12x12 board and regions
(defparameter board12
  '((0 0 0 0 1 0 5 7 0 0 0 6)
    (0 0 0 4 3 0 3 5 0 0 0 0)
    (0 4 0 6 0 0 0 3 0 3 0 4)
    (0 0 1 5 7 0 0 0 6 7 0 2)
    (0 0 0 2 0 2 0 0 0 4 0 0)
    (0 0 4 0 0 0 0 0 0 3 0 2)
    (6 0 0 0 0 2 0 0 4 0 0 4)
    (0 0 0 0 2 0 4 0 3 6 0 0)
    (0 3 0 0 0 3 0 5 0 0 1 5)
    (0 0 4 0 5 2 0 3 0 4 0 0)
    (0 3 0 0 0 0 4 0 0 0 0 2)
    (0 0 2 0 2 0 3 0 0 0 4 0)))

(defparameter regions-board12
  '((0 1 1 2 2 2 2 7 7 7 8 8)
    (0 3 3 3 3 6 2 7 7 7 8 8)
    (0 4 3 5 5 6 6 9 9 7 8 8)
    (0 4 4 5 6 6 6 9 10 10 10 10)
    (0 4 16 5 5 6 22 9 11 10 10 10)
    (16 16 16 5 21 21 22 23 11 13 12 12)
    (16 16 17 24 24 21 22 23 23 13 13 13)
    (18 16 17 25 25 21 26 23 23 28 13 14)
    (18 18 17 25 26 26 26 27 27 28 13 15)
    (18 18 19 25 25 27 27 27 27 28 28 15)
    (18 19 19 19 29 29 29 29 29 28 15 15)
    (18 20 20 20 30 30 31 31 31 28 15 15)))

;; Example 14x14 board and regions
(defparameter board14
  '((4 2 0 6 0 4 0 2 0 4 0 2 4 0)
    (0 0 0 4 1 0 0 3 0 0 6 0 0 5)
    (1 0 0 0 0 0 0 0 2 0 0 0 0 0)
    (0 5 0 0 0 1 0 4 0 5 0 3 0 0)
    (0 0 3 2 4 0 0 0 1 0 3 0 4 0)
    (2 1 0 0 0 0 3 0 0 0 0 5 0 0)
    (6 0 0 0 0 3 0 0 4 6 0 3 7 0)
    (0 0 4 0 7 0 5 0 1 0 0 0 0 0)
    (2 0 3 0 0 4 0 4 3 1 5 0 0 0)
    (0 0 0 0 2 0 0 0 1 5 0 0 0 0)
    (0 1 0 5 0 0 0 0 0 0 2 0 2 0)
    (4 0 5 3 6 5 3 0 1 0 0 4 0 5)
    (0 1 0 0 0 3 0 6 0 4 5 0 0 0)
    (0 3 0 0 2 0 2 1 0 1 6 2 0 5)))

(defparameter regions-board14
  '((1 2 2 2 2 2 4 4 4 6 7 7 8 9)
    (1 1 3 3 2 5 5 6 6 6 6 7 8 8)
    (1 1 3 3 10 10 12 12 6 14 14 8 8 15)
    (17 1 18 18 10 10 13 13 14 14 14 16 16 15)
    (17 1 19 18 10 11 13 13 14 21 21 21 16 15)
    (20 20 19 19 10 11 23 23 23 22 22 24 16 16)
    (26 26 19 28 28 29 29 29 29 29 24 24 24 25)
    (26 26 26 31 31 32 34 30 30 29 24 24 24 25)
    (26 27 27 31 31 31 34 34 35 29 36 37 38 25)
    (26 27 27 31 31 33 34 35 35 35 36 37 38 38)
    (47 27 46 46 46 34 34 34 44 35 36 36 39 38)
    (47 48 48 46 45 45 44 44 44 35 36 39 39 39)
    (47 48 48 46 45 45 45 42 42 42 42 39 41 40)
    (47 47 48 46 45 43 42 42 42 41 41 41 41 41)))


;; Example 17x17 board and regions
(defparameter board17
  '((0 0 3 0 2 0 3 0 0 0 7 0 0 5 0 3 6)
    (0 0 0 0 0 2 0 6 0 2 0 0 3 0 0 2 0)
    (0 2 0 0 0 0 0 0 4 0 5 1 0 2 0 0 0)
    (3 0 7 0 0 5 0 0 0 0 0 7 4 0 2 0 0)
    (2 1 0 2 0 0 0 3 0 5 0 0 6 0 0 0 1)
    (0 3 4 0 0 0 3 0 0 0 3 0 5 0 0 0 3)
    (3 1 0 0 0 0 0 4 0 0 0 0 0 0 0 0 0)
    (0 7 0 5 2 6 0 0 0 0 1 0 1 0 2 0 6)
    (0 0 5 0 0 2 0 5 0 5 0 7 0 3 0 4 0)
    (0 0 0 0 7 0 3 0 2 3 0 0 4 0 0 3 1)
    (5 0 3 0 5 0 6 0 0 4 0 4 0 3 0 0 0)
    (0 0 0 6 0 0 0 0 4 0 5 0 0 2 0 2 0)
    (0 0 0 0 2 0 0 2 0 0 0 1 0 0 4 0 5)
    (0 6 3 4 0 4 5 0 6 2 0 0 1 4 0 3 0)
    (0 2 0 0 0 0 3 0 4 0 3 0 6 0 0 0 0)
    (0 0 4 0 0 0 0 0 0 0 0 0 0 0 0 3 0)
    (6 2 0 0 1 3 1 7 1 2 0 4 0 4 1 0 6)))

(defparameter regions-board17
  '((0 1 1 1 1 2 3 4 4 5 6 6 7 7 8 9 9)
    (10 11 11 12 3 3 3 13 13 13 6 6 6 7 7 9 9)
    (10 10 12 12 14 14 14 13 13 13 6 6 7 7 9 9 9)
    (15 15 16 16 16 14 14 17 17 18 18 18 18 19 19 20 20)
    (15 15 16 16 21 22 14 17 17 18 23 24 19 19 25 26 20)
    (27 28 16 16 21 22 22 22 18 18 23 19 19 25 25 26 26)
    (29 28 28 29 21 30 30 22 31 23 23 32 19 25 25 33 34)
    (29 29 29 29 29 35 30 30 31 23 23 32 32 25 33 33 36)
    (37 38 38 38 35 35 35 30 31 39 39 39 40 40 33 36 36)
    (37 37 38 41 41 35 35 30 43 39 39 39 44 40 36 36 36)
    (37 37 38 41 41 41 42 43 43 43 45 39 44 44 44 44 46)
    (37 37 38 38 47 41 42 42 48 48 45 45 45 44 49 46 46)
    (50 51 51 52 47 41 42 42 54 48 48 45 45 49 49 49 49)
    (50 50 51 52 47 47 53 42 55 48 48 56 57 57 49 58 58)
    (50 50 51 52 52 53 53 59 55 55 56 56 56 57 60 58 58)
    (50 50 61 61 52 53 53 59 55 55 56 62 62 57 60 60 63)
    (61 61 61 61 52 52 53 53 55 55 56 56 62 60 60 60 60)))
